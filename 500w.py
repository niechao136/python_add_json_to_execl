import xlrd
import xlwt

data = xlrd.open_workbook("ssqexcle_result.xls")
table = data.sheets()[0]
result = dict(
    blue={
        "01": 0,
        "02": 0,
        "03": 0,
        "04": 0,
        "05": 0,
        "06": 0,
        "07": 0,
        "08": 0,
        "09": 0,
        "10": 0,
        "11": 0,
        "12": 0,
        "13": 0,
        "14": 0,
        "15": 0,
        "16": 0
    },
    red1={
        "01": 0,
        "02": 0,
        "03": 0,
        "04": 0,
        "05": 0,
        "06": 0,
        "07": 0,
        "08": 0,
        "09": 0,
        "10": 0,
        "11": 0,
        "12": 0,
        "13": 0,
        "14": 0,
        "15": 0,
        "16": 0,
        "17": 0,
        "18": 0,
        "19": 0,
        "20": 0,
        "21": 0,
        "22": 0,
        "23": 0,
        "24": 0,
        "25": 0,
        "26": 0,
        "27": 0,
        "28": 0,
        "29": 0,
        "30": 0,
        "31": 0,
        "32": 0,
        "33": 0
    },
    red2={
        "01": 0,
        "02": 0,
        "03": 0,
        "04": 0,
        "05": 0,
        "06": 0,
        "07": 0,
        "08": 0,
        "09": 0,
        "10": 0,
        "11": 0,
        "12": 0,
        "13": 0,
        "14": 0,
        "15": 0,
        "16": 0,
        "17": 0,
        "18": 0,
        "19": 0,
        "20": 0,
        "21": 0,
        "22": 0,
        "23": 0,
        "24": 0,
        "25": 0,
        "26": 0,
        "27": 0,
        "28": 0,
        "29": 0,
        "30": 0,
        "31": 0,
        "32": 0,
        "33": 0
    },
    red3={
        "01": 0,
        "02": 0,
        "03": 0,
        "04": 0,
        "05": 0,
        "06": 0,
        "07": 0,
        "08": 0,
        "09": 0,
        "10": 0,
        "11": 0,
        "12": 0,
        "13": 0,
        "14": 0,
        "15": 0,
        "16": 0,
        "17": 0,
        "18": 0,
        "19": 0,
        "20": 0,
        "21": 0,
        "22": 0,
        "23": 0,
        "24": 0,
        "25": 0,
        "26": 0,
        "27": 0,
        "28": 0,
        "29": 0,
        "30": 0,
        "31": 0,
        "32": 0,
        "33": 0
    },
    red4={
        "01": 0,
        "02": 0,
        "03": 0,
        "04": 0,
        "05": 0,
        "06": 0,
        "07": 0,
        "08": 0,
        "09": 0,
        "10": 0,
        "11": 0,
        "12": 0,
        "13": 0,
        "14": 0,
        "15": 0,
        "16": 0,
        "17": 0,
        "18": 0,
        "19": 0,
        "20": 0,
        "21": 0,
        "22": 0,
        "23": 0,
        "24": 0,
        "25": 0,
        "26": 0,
        "27": 0,
        "28": 0,
        "29": 0,
        "30": 0,
        "31": 0,
        "32": 0,
        "33": 0
    },
    red5={
        "01": 0,
        "02": 0,
        "03": 0,
        "04": 0,
        "05": 0,
        "06": 0,
        "07": 0,
        "08": 0,
        "09": 0,
        "10": 0,
        "11": 0,
        "12": 0,
        "13": 0,
        "14": 0,
        "15": 0,
        "16": 0,
        "17": 0,
        "18": 0,
        "19": 0,
        "20": 0,
        "21": 0,
        "22": 0,
        "23": 0,
        "24": 0,
        "25": 0,
        "26": 0,
        "27": 0,
        "28": 0,
        "29": 0,
        "30": 0,
        "31": 0,
        "32": 0,
        "33": 0
    },
    red6={
        "01": 0,
        "02": 0,
        "03": 0,
        "04": 0,
        "05": 0,
        "06": 0,
        "07": 0,
        "08": 0,
        "09": 0,
        "10": 0,
        "11": 0,
        "12": 0,
        "13": 0,
        "14": 0,
        "15": 0,
        "16": 0,
        "17": 0,
        "18": 0,
        "19": 0,
        "20": 0,
        "21": 0,
        "22": 0,
        "23": 0,
        "24": 0,
        "25": 0,
        "26": 0,
        "27": 0,
        "28": 0,
        "29": 0,
        "30": 0,
        "31": 0,
        "32": 0,
        "33": 0
    }
)
red = {}
num = {}
for row in range(table.nrows):
    if row > 1:
        redSum = 0
        string = ""
        for col in range(table.ncols):
            if 2 < col < 9:
                result["red" + str(col - 2)][table.cell(row, col).value] += 1
                redSum += int(table.cell(row, col).value)
                string += (table.cell(row, col).value + "/")
            elif col == 9:
                group = table.cell(row, col).value.split(",")
                for item in group:
                    result["blue"][item] += 1
                string += (group[0] + "/")
        if redSum in red.keys():
            red[redSum] += 1
        else:
            red[redSum] = 1
        if string in num.keys():
            num[string] += 1
        else:
            num[string] = 1


for s in num.keys():
    if num[s] > 1:
        print(s)
    if s == "03/15/17/18/29/33/14" or s == "05/19/21/23/27/32/13" or s == "12/18/21/27/29/32/07":
        print(s)
    if s == "04/09/14/20/22/31/04" or s == "02/08/11/14/23/27/16":
        print(s)
    # else:
    #     print(s, 1)
book = xlwt.Workbook()
sheet = book.add_sheet('Sheet1', cell_overwrite_ok=True)
title = [
    "数字",
    "1号红球出现次数",
    "2号红球出现次数",
    "3号红球出现次数",
    "4号红球出现次数",
    "5号红球出现次数",
    "6号红球出现次数",
    "蓝球出现次数"
]
for i in range(len(title)):
    sheet.write(0, i, title[i])
row = 1
for i in result["red1"]:
    sheet.write(row, 0, i)
    sheet.write(row, 1, result["red1"][i])
    sheet.write(row, 2, result["red2"][i])
    sheet.write(row, 3, result["red3"][i])
    sheet.write(row, 4, result["red4"][i])
    sheet.write(row, 5, result["red5"][i])
    sheet.write(row, 6, result["red6"][i])
    if int(i) < 17:
        sheet.write(row, 7, result["blue"][i])
    row += 1
# book.save('result.xls')
